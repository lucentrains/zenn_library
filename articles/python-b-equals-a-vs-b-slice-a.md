---
title: "b = a と b = a[:] の違いを説明できますか？"
emoji: "🐍"
type: "tech"
topics: ["Python"]
published: true
---


## 1. はじめに

Python でリストや他のオブジェクトを複製するとき、  
`b = a` と `b = a[:]` には大きな違いがあります。  
まずはその違いを押さえたうえで、コピーの深さによって挙動がどう変わるのかを整理しましょう。

## 🎯 先に結論：`b = a` と `b = a[:]` の違い

| 記述 | 動作 | 変更の影響 | メモリ効率 |
| --- | --- | --- | --- |
| `b = a` | **参照渡し** – `b` と `a` は同じリストを指す | 片方を変更するともう片方も変わる | ◎（コピーなし） |
| `b = a[:]` | **浅いコピー** – 新しいリストオブジェクトを作成 | 第一層の変更は独立。入れ子要素は共有 | ◯（リスト本体のみ複製） |


---

## 📌 まず用語の整理

| 用語 | 意味 | 元データとの関係 |
| --- | --- | --- |
| **参照渡し (reference)** | 元データへの参照のみ渡す。複製はしない。 | 常に影響を受ける |
| **浅いコピー (shallow copy)** | 表面（第一層）だけを複製。内部の入れ子データまでは複製しない。 | 第一層までは影響なし、入れ子データは影響を受ける |
| **深いコピー (deep copy)** | すべての階層を完全に複製。 | 一切影響を受けない |

---

## 2. 参照渡し（Reference）

変数はデータそのものではなく、  
**データが存在するメモリ位置へのポインタ（参照）** を保持します。

```python
a = [1, 2, 3]
b = a          # 参照渡し

b[0] = 100
print(a)  # [100, 2, 3]  ← a も変わる
print(b)  # [100, 2, 3]
```

メモリイメージ:

```
a ──┐
    ├─▶ [1, 2, 3]
b ──┘    (同じメモリ領域を共有)
```

**特徴**

- メモリ効率が良い（複製しない）
- 片方を変更するともう片方にも影響が及ぶ

---

## 3. 浅いコピー（Shallow Copy）

最上位層だけをコピーし、  
**入れ子要素は元データと共有** します。

```python
import copy

a = [1, [2, 3], 4]
b = copy.copy(a)   # または a[:] でも可

b[0] = 100         # 第一層の変更
b[1][0] = 200      # 入れ子要素の変更

print("a:", a)  # [1, [200, 3], 4] ← 入れ子要素は影響あり
print("b:", b)  # [100, [200, 3], 4]
```

メモリイメージ:

```
a ──▶ [ 1  , ──▶ [2, 3] , 4 ]
           ↑          ↑
b ──▶ [100 , ──▶ [2, 3] , 4 ]
```

**特徴**

- 第一層の変更は独立
- 入れ子要素の変更は元データに波及

---

## 4. 深いコピー（Deep Copy）

オブジェクトとその中身を **再帰的にすべて複製** します。

```python
import copy

a = [1, [2, 3], 4]
b = copy.deepcopy(a)

b[0] = 100          # 第一層の変更
b[1][0] = 200       # 入れ子要素の変更

print("a:", a)  # [1, [2, 3], 4] ← 一切影響なし
print("b:", b)  # [100, [200, 3], 4]
```

メモリイメージ:

```
a ──▶ [ 1   , ──▶ [2  , 3] , 4 ]
b ──▶ [100  , ──▶ [200, 3] , 4 ]   (完全に独立)
```

**特徴**

- 変更が元データに波及しない
- メモリと処理コストは大きい

---

## 5. まとめ表

| 種類 | コピー範囲 | メモリ効率 | 元データへの影響 |
| --- | --- | --- | --- |
| 参照渡し | コピーしない（参照のみ） | ◎ | あり |
| 浅いコピー | 第一層のみ | ◯ | 入れ子要素は影響あり |
| 深いコピー | すべてをコピー | △ | なし |

---

## 6. 利用指針（いつ何を使うべき？）

- **参照渡し**  
  - メモリを節約したいとき  
  - 同じデータを共有し、変更が相互に反映されてよい場合

- **浅いコピー**  
  - 入れ子構造がない、または内部要素がイミュータブルなとき  
  - トップレベルだけ独立させたい場合

- **深いコピー**  
  - ネストが深い複雑なデータを完全に分離したい場合  
  - 変更が元データに波及しては困る場合

---

## 7. 実用的ヒント

- **単純な1次元リスト** ➡︎ 浅いコピー (`a[:]` または `copy.copy(a)`)
- **複雑な入れ子構造** ➡︎ 深いコピー (`copy.deepcopy(a)`)

---

## 8. 🎯 最後のまとめ

- Python の変数は参照を保持する  
- コピーの深さで元データとの依存関係が変わる  
- シーンに合わせて「参照」「浅いコピー」「深いコピー」を正しく使い分ける  

これらを理解すれば、予期せぬ副作用を防ぎ、安全で効率的なコードを書くことができます。
